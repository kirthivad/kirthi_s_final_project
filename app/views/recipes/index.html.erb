<div class="page-header">
  <h1>
    Chef at Home
  </h1>
  <h2>
    Find a Recipe to Make Tonight!
  </h2>
</div>

<div class="container">
  <div class="row mb-1">
    <div class="col-md-12">
      <%= search_form_for @q, :id => "recipes_filters" do |f| %>
        <p class="lead"> <h3> Recipe Finder </h3> </p>
  
    <div class="form-group">
      <%= f.label :ingredient_list_cont, "Ingredients" %>
      <%= f.text_field :ingredient_list_cont, :class => "form-control", :placeholder => "What ingredients do you have?" %>
    </div>
  
    <div class="form-group">
      <%= f.label :recipe_name_cont, "Recipe Name" %>
      <%= f.text_field :recipe_name_cont, :class => "form-control", :placeholder => "What recipe would you like?" %>
    </div>
    
    <div class="form-group">
      <%= f.label :recipe_type_cont, "Cuisine Type" %>
      <%= f.text_field :recipe_type_cont, :class => "form-control", :placeholder => "What cuisine type would you like?" %>
    </div>
  
        <%= f.submit :class => "btn btn-primary btn-block mb-1" %>
  
        <a href="/recipes" class="btn btn-default btn-block mb-1">Clear filters</a>
      <% end %>
    </div>
  </div>
  <div class="row mb-1">
    <div class="col-md-12">
      <a href="/recipes/new" class="btn btn-success btn-block">Add a New Recipe</a>
    </div>
  </div>
</div>

<div class="container">
  <div class="row">
    <div class="col-md-12">
      <table class="table table-striped table-hover">
        <tr class="col-sm">
          <th class="col-xs-1">Recipe Name</th>
          <th class="col-xs-1">Ingredient List</th>
          <th class="col-xs-3">Instructions</th>
          <th class="col-xs-1">Cuisine Type</th>
          <th class="col-xs-1">Actions</th>
        </tr>
        <% @recipes.each do |recipe| %>
        <tr>
          <td><a href="/recipes/<%= recipe.id%>"> <%= recipe.recipe_name %> </a></td>
          <td><%= recipe.ingredient_list %></td>
          <td><%= truncate(recipe.instructions, length:130) %></td>
          <td><%= recipe.recipe_type %></td>
          <td>
            <ul class="list-unstyled">
            <% if recipe.bookmarks.find_by(:user_id => current_user.id) %>
              <li><a href="/delete_bookmark/<%=recipe.bookmarks.find_by(:user_id => current_user.id).id%>">
                <i class="fa fa-fw fa-heart"></i> Remove Bookmark
              </a> </li>
              <% else %>
              <form action="/create_bookmark" method="post">
                  <!-- Hidden input for authenticity token to protect from forgery -->
                  <input name="authenticity_token" type="hidden" value="<%= form_authenticity_token %>">
                  
                  <input type="hidden" name="user_id" value="<%=current_user.id%>">
              
                  <input type="hidden" name="recipe_id" value="<%= recipe.id%>">
              
                  <li><button class="btn-link">
                    <i class="fa fa-fw fa-heart-o"></i> Bookmark
                  </button></li>
              </form>
            <% end %>
            <% if recipe.user_id == current_user.id %>
              <li><a href="/recipes/<%= recipe.id %>/edit" class="btn-link"><i class="fa fa-pencil fa-fw"></i>Edit</a></li>
              <li><a href="/delete_recipe/<%= recipe.id %>" class="btn-link" rel="nofollow"><i class="fa fa-trash-o fa-fw"></i>Delete</a></li>
            <% end %>
            </ul>
          </td>
        </tr>
        <% end %>
      </table>
      <%= paginate @recipes, theme: 'twitter-bootstrap-4' %>
    </div>
  </div>
</div>